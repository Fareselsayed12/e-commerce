import{a as y,b as a,c as x,d as v,g as C,h as F,i as w,j as S,k as I}from"./chunk-X4Y7SZ5H.js";import{c as k}from"./chunk-ORRIWDRT.js";import{t as h}from"./chunk-ASQXGKJR.js";import{Bb as n,Ja as s,P as p,Ta as f,U as g,V as l,db as u,kb as o,lb as t,mb as m,tb as b}from"./chunk-4MBWPL2H.js";import"./chunk-2NFLSA4Y.js";var d=class i{constructor(e){this.httpClient=e}userToken=localStorage.getItem("token");checkoutPayment(e,r){return this.httpClient.post(`https://ecommerce.routemisr.com/api/v1/orders/checkout-session/${e}?url=http://localhost:4200`,{shippingAddress:r})}static \u0275fac=function(r){return new(r||i)(g(h))};static \u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"})};var N=class i{formBuilder=l(S);activatedRoute=l(k);ordersService=l(d);checkoutForm;cartId="";ngOnInit(){this.checkoutForm=this.formBuilder.group({details:[null,[a.required]],phone:[null,[a.required,a.pattern(/^01[0125][0-9]{8}$/)]],city:[null,[a.required]]}),this.getCartId()}getCartId(){this.activatedRoute.paramMap.subscribe({next:e=>{this.cartId=e.get("id")}})}submitForm(){console.log(this.checkoutForm.value),this.ordersService.checkoutPayment(this.cartId,this.checkoutForm.value).subscribe({next:e=>{console.log(e),e.status==="success"&&open(e.session.url,"_self")},error:e=>{console.log(e)}})}static \u0275fac=function(r){return new(r||i)};static \u0275cmp=f({type:i,selectors:[["app-checkout"]],decls:18,vars:2,consts:[[1,"w-1/2","mx-auto"],[1,"text-3xl","text-green-500","text-center"],[3,"ngSubmit","formGroup"],[1,"mb-1"],["for","details",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","details","id","details",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-green-500","dark:focus:border-green-500"],["for","phone",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","phone","id","phone","type","tel",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-green-500","dark:focus:border-green-500"],["for","city",1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","city","id","city","type","text",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-green-500","dark:focus:border-green-500"],["type","submit",1,"main-btn","mt-2",3,"disabled"]],template:function(r,c){r&1&&(o(0,"section",0)(1,"h1",1),n(2,"Checkout"),t(),o(3,"form",2),b("ngSubmit",function(){return c.submitForm()}),o(4,"div",3)(5,"label",4),n(6,"Details"),t(),m(7,"textarea",5),t(),o(8,"div",3)(9,"label",6),n(10,"Phone"),t(),m(11,"input",7),t(),o(12,"div",3)(13,"label",8),n(14,"City"),t(),m(15,"input",9),t(),o(16,"button",10),n(17,"Online Payment"),t()()()),r&2&&(s(3),u("formGroup",c.checkoutForm),s(13),u("disabled",c.checkoutForm.invalid))},dependencies:[I,C,y,x,v,F,w],encapsulation:2})};export{N as CheckoutComponent};
